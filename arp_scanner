#for creating this code you must known about network and protocol
from socket import timeout
from scapy.all import srp, Ether, ARP, conf
import sys

if len(sys.argv) != 2:
    print ("Usage : nssarp.py NetWork")
    print ("Example: nssarp.py 192.168.1.0/24")
    sys.exit()
conf.verb=0

ans,unans = srp(Ether(dst = "ff.ff.ff.ff.ff.ff")/ARP(pdst=sys.argv[1]), timeout=2)

for s,r in ans :
    print(r.sprint("%Ether.src%%ARP.psrc%"))
